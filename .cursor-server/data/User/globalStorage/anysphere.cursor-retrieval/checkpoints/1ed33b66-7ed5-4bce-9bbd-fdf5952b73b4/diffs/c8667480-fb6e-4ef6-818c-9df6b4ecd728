{"fsPath":"\\home\\hendo420\\soraFeed\\src\\components\\VideoPost.tsx","fileUuid":"c8667480-fb6e-4ef6-818c-9df6b4ecd728","fileSizeBytes":5654,"numLines":187,"diffChanges":[{"originalStartLineNumberOneIndexed":1,"originalEndLineNumberExclusiveOneIndexed":1,"modifiedStartLineNumberOneIndexed":1,"modifiedEndLineNumberExclusiveOneIndexed":188,"addedLines":["'use client';","","import { useState, useRef, useEffect } from 'react';","import { motion } from 'framer-motion';","import { Play, Pause, Volume2, VolumeX, Heart, Share, User, CheckCircle } from 'lucide-react';","import { SoraFeedItem } from '@/types/sora';","","interface VideoPostProps {","  item: SoraFeedItem;","  isActive: boolean;","  onNext: () => void;","  onPrevious: () => void;","}","","export default function VideoPost({ item, isActive }: VideoPostProps) {","  const [isPlaying, setIsPlaying] = useState(false);","  const [isMuted, setIsMuted] = useState(true);","  const [isLiked, setIsLiked] = useState(false);","  const videoRef = useRef<HTMLVideoElement>(null);","","  const videoUrl = item.post.attachments[0]?.encodings?.md?.path || ","                   item.post.attachments[0]?.encodings?.source?.path;","","  useEffect(() => {","    const video = videoRef.current;","    if (!video) return;","","    if (isActive) {","      video.play().then(() => {","        setIsPlaying(true);","      }).catch(() => {","        setIsPlaying(false);","      });","    } else {","      video.pause();","      setIsPlaying(false);","    }","  }, [isActive]);","","  const togglePlayPause = () => {","    const video = videoRef.current;","    if (!video) return;","","    if (isPlaying) {","      video.pause();","      setIsPlaying(false);","    } else {","      video.play().then(() => {","        setIsPlaying(true);","      }).catch(() => {","        setIsPlaying(false);","      });","    }","  };","","  const toggleMute = () => {","    const video = videoRef.current;","    if (!video) return;","","    video.muted = !video.muted;","    setIsMuted(video.muted);","  };","","  const handleVideoEnd = () => {","    setIsPlaying(false);","  };","","  const formatCount = (count: number): string => {","    if (count >= 1000000) {","      return (count / 1000000).toFixed(1) + 'M';","    } else if (count >= 1000) {","      return (count / 1000).toFixed(1) + 'K';","    }","    return count.toString();","  };","","  const formatTimeAgo = (timestamp: number): string => {","    const now = Date.now() / 1000;","    const diff = now - timestamp;","    ","    if (diff < 60) return 'now';","    if (diff < 3600) return `${Math.floor(diff / 60)}m`;","    if (diff < 86400) return `${Math.floor(diff / 3600)}h`;","    return `${Math.floor(diff / 86400)}d`;","  };","","  return (","    <div className=\"relative w-full h-full flex items-center justify-center bg-black\">","      {/* Video */}","      <video","        ref={videoRef}","        className=\"w-full h-full object-cover\"","        loop","        muted={isMuted}","        playsInline","        onEnded={handleVideoEnd}","        poster={item.post.attachments[0]?.encodings?.thumbnail?.path}","      >","        {videoUrl && <source src={videoUrl} type=\"video/mp4\" />}","      </video>","","      {/* Play/Pause Overlay */}","      <motion.div","        initial={{ opacity: 0, scale: 0.8 }}","        animate={{ opacity: isPlaying ? 0 : 1, scale: isPlaying ? 0.8 : 1 }}","        className=\"absolute inset-0 flex items-center justify-center pointer-events-none\"","      >","        <div className=\"p-4 rounded-full bg-black/50 backdrop-blur-sm\">","          <Play size={48} className=\"text-white ml-1\" />","        </div>","      </motion.div>","","      {/* Click to play/pause */}","      <div ","        className=\"absolute inset-0 cursor-pointer\"","        onClick={togglePlayPause}","      />","","      {/* Controls */}","      <div className=\"absolute bottom-4 left-4 right-20 z-10\">","        {/* User Info */}","        <div className=\"flex items-center gap-3 mb-3\">","          <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">","            <User size={20} className=\"text-white\" />","          </div>","          <div className=\"flex-1\">","            <div className=\"flex items-center gap-2\">","              <span className=\"text-white font-semibold\">","                {item.profile.display_name || item.profile.username}","              </span>","              {item.profile.verified && (","                <CheckCircle size={16} className=\"text-blue-500\" />","              )}","              <span className=\"text-white/70 text-sm\">","                {formatTimeAgo(item.post.posted_at)}","              </span>","            </div>","            <div className=\"text-white/70 text-sm\">","              {formatCount(item.profile.follower_count)} followers","            </div>","          </div>","        </div>","","        {/* Caption */}","        {item.post.text && (","          <p className=\"text-white text-sm mb-2 line-clamp-3\">","            {item.post.text}","          </p>","        )}","      </div>","","      {/* Right Side Actions */}","      <div className=\"absolute bottom-4 right-4 flex flex-col gap-4 z-10\">","        <button","          onClick={() => setIsLiked(!isLiked)}","          className={`p-3 rounded-full transition-all ${","            isLiked ? 'bg-red-500 text-white' : 'bg-black/50 text-white hover:bg-black/70'","          }`}","        >","          <Heart size={20} fill={isLiked ? 'currentColor' : 'none'} />","        </button>","","        <button className=\"p-3 rounded-full bg-black/50 text-white hover:bg-black/70 transition-all\">","          <Share size={20} />","        </button>","","        <button","          onClick={toggleMute}","          className=\"p-3 rounded-full bg-black/50 text-white hover:bg-black/70 transition-all\"","        >","          {isMuted ? <VolumeX size={20} /> : <Volume2 size={20} />}","        </button>","      </div>","","      {/* Top Controls */}","      <div className=\"absolute top-4 right-4 z-10\">","        <button","          onClick={togglePlayPause}","          className=\"p-2 rounded-full bg-black/50 text-white hover:bg-black/70 transition-all\"","        >","          {isPlaying ? <Pause size={16} /> : <Play size={16} />}","        </button>","      </div>","    </div>","  );","}",""],"tokenizedAddedLines":[1000000,1000001,1000002,1000003,1000004,1000005,1000001,1000006,1000007,1000008,1000009,1000010,1000011,1000001,1000012,1000013,1000014,1000015,1000016,1000001,1000017,1000018,1000001,1000019,1000020,1000021,1000001,1000022,1000023,1000024,1000025,1000026,1000027,1000028,1000029,1000030,1000031,1000032,1000001,1000033,1000020,1000021,1000001,1000034,1000029,1000030,1000028,1000023,1000024,1000025,1000026,1000027,1000031,1000035,1000001,1000036,1000020,1000021,1000001,1000037,1000038,1000035,1000001,1000039,1000040,1000035,1000001,1000041,1000042,1000043,1000044,1000045,1000031,1000046,1000035,1000001,1000047,1000048,1000049,1000050,1000051,1000052,1000053,1000054,1000035,1000001,1000055,1000056,1000057,1000058,1000059,1000060,1000061,1000062,1000063,1000064,1000065,1000066,1000067,1000068,1000001,1000069,1000070,1000071,1000072,1000073,1000066,1000074,1000075,1000076,1000077,1000001,1000078,1000079,1000080,1000081,1000082,1000001,1000083,1000084,1000085,1000086,1000087,1000088,1000089,1000090,1000091,1000092,1000093,1000094,1000095,1000096,1000097,1000098,1000099,1000094,1000100,1000101,1000102,1000100,1000089,1000076,1000001,1000103,1000104,1000105,1000106,1000107,1000108,1000109,1000001,1000110,1000111,1000112,1000113,1000114,1000115,1000116,1000117,1000118,1000119,1000001,1000120,1000121,1000119,1000001,1000112,1000122,1000123,1000117,1000124,1000119,1000109,1000001,1000125,1000126,1000112,1000127,1000128,1000117,1000129,1000119,1000109,1000130,1000131,1000011,1000001]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_ADDED"}