{"fsPath":"\\home\\hendo420\\soraFeed\\src\\app\\api\\scanner\\stats\\route.ts","fileUuid":"f6f25a51-12d8-4556-8aa4-b6c396d8253c","fileSizeBytes":5451,"numLines":164,"diffChanges":[{"originalStartLineNumberOneIndexed":41,"originalEndLineNumberExclusiveOneIndexed":41,"modifiedStartLineNumberOneIndexed":41,"modifiedEndLineNumberExclusiveOneIndexed":105,"addedLines":["","    // Get database size and storage metrics","    const dbSizeResult = await query(`","      SELECT ","        pg_size_pretty(pg_database_size(current_database())) as database_size,","        pg_database_size(current_database()) as database_size_bytes","    `);","","    // Get table size metrics","    const tableSizeResult = await query(`","      SELECT ","        schemaname,","        tablename,","        pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) as size,","        pg_total_relation_size(schemaname||'.'||tablename) as size_bytes,","        pg_size_pretty(pg_relation_size(schemaname||'.'||tablename)) as table_size,","        pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename) - pg_relation_size(schemaname||'.'||tablename)) as index_size","      FROM pg_tables ","      WHERE schemaname = 'public'","      ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC","    `);","","    // Get database performance metrics","    const performanceResult = await query(`","      SELECT ","        numbackends as active_connections,","        xact_commit as transactions_committed,","        xact_rollback as transactions_rolled_back,","        blks_read as disk_blocks_read,","        blks_hit as buffer_hits,","        tup_returned as tuples_returned,","        tup_fetched as tuples_fetched,","        tup_inserted as tuples_inserted,","        tup_updated as tuples_updated,","        tup_deleted as tuples_deleted,","        ROUND((blks_hit::float / NULLIF(blks_hit + blks_read, 0)) * 100, 2) as cache_hit_ratio","      FROM pg_stat_database ","      WHERE datname = current_database()","    `);","","    // Get index usage statistics","    const indexStatsResult = await query(`","      SELECT ","        schemaname,","        tablename,","        indexname,","        idx_tup_read as index_tuples_read,","        idx_tup_fetch as index_tuples_fetched","      FROM pg_stat_user_indexes ","      WHERE schemaname = 'public'","      ORDER BY idx_tup_read DESC","      LIMIT 10","    `);","","    // Get memory and connection info","    const memoryResult = await query(`","      SELECT ","        setting as max_connections,","        (SELECT setting FROM pg_settings WHERE name = 'shared_buffers') as shared_buffers,","        (SELECT setting FROM pg_settings WHERE name = 'effective_cache_size') as effective_cache_size,","        (SELECT setting FROM pg_settings WHERE name = 'work_mem') as work_mem","      FROM pg_settings ","      WHERE name = 'max_connections'","    `);"],"tokenizedAddedLines":[3,1000083,1000084,30,1000085,1000086,27,3,1000087,1000088,30,1000089,1000090,1000091,1000092,1000093,1000094,1000095,1000096,1000097,27,3,1000098,1000099,30,1000100,1000101,1000102,1000103,1000104,1000105,1000106,1000107,1000108,1000109,1000110,1000111,1000112,27,3,1000113,1000114,30,1000089,1000090,1000115,1000116,1000117,1000118,1000096,1000119,26,27,3,1000120,1000121,30,1000122,1000123,1000124,1000125,1000126,1000127,27]},{"originalStartLineNumberOneIndexed":56,"originalEndLineNumberExclusiveOneIndexed":57,"modifiedStartLineNumberOneIndexed":120,"modifiedEndLineNumberExclusiveOneIndexed":129,"addedLines":["        dailyStats: dailyStatsResult.rows,","        storage: {","          databaseSize: dbSizeResult.rows[0]?.database_size || 'Unknown',","          databaseSizeBytes: dbSizeResult.rows[0]?.database_size_bytes || 0,","          tables: tableSizeResult.rows || []","        },","        performance: performanceResult.rows[0] || {},","        indexes: indexStatsResult.rows || [],","        memory: memoryResult.rows[0] || {}"],"tokenizedAddedLines":[1000128,1000129,1000130,1000131,1000132,70,1000133,1000134,1000135]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}