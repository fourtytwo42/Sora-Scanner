{"fsPath":"\\home\\hendo420\\soraFeed\\src\\components\\VideoPost.tsx","fileUuid":"21a23e58-2de4-4de8-bfb7-3e3388392272","fileSizeBytes":51147,"numLines":1247,"diffChanges":[{"originalStartLineNumberOneIndexed":9,"originalEndLineNumberExclusiveOneIndexed":9,"modifiedStartLineNumberOneIndexed":9,"modifiedEndLineNumberExclusiveOneIndexed":27,"addedLines":["","// Store video playback positions across component unmounts/remounts","const videoPlaybackState = new Map<string, {","  currentTime: number;","  wasPlaying: boolean;","  timestamp: number;","}>();","","// Clean up old entries (older than 30 seconds)","const cleanupPlaybackState = () => {","  const now = Date.now();","  const maxAge = 30000; // 30 seconds","  for (const [url, state] of videoPlaybackState.entries()) {","    if (now - state.timestamp > maxAge) {","      videoPlaybackState.delete(url);","    }","  }","};"],"tokenizedAddedLines":[2,1000821,1000822,1000823,1000824,1000825,1000826,2,1000827,1000828,1000829,1000830,1000831,1000832,1000833,49,1000834,1000835]},{"originalStartLineNumberOneIndexed":550,"originalEndLineNumberExclusiveOneIndexed":551,"modifiedStartLineNumberOneIndexed":568,"modifiedEndLineNumberExclusiveOneIndexed":569,"addedLines":["  // Component mount/unmount - save/restore playback position"],"tokenizedAddedLines":[1000836]},{"originalStartLineNumberOneIndexed":553,"originalEndLineNumberExclusiveOneIndexed":553,"modifiedStartLineNumberOneIndexed":571,"modifiedEndLineNumberExclusiveOneIndexed":580,"addedLines":["    cleanupPlaybackState(); // Clean up old entries","    ","    // Check if we have saved state for this video","    if (currentVideoUrl) {","      const savedState = videoPlaybackState.get(currentVideoUrl);","      if (savedState) {","        console.log('üíæ Found saved playback state:', { currentTime: savedState.currentTime.toFixed(2), wasPlaying: savedState.wasPlaying });","      }","    }"],"tokenizedAddedLines":[1000837,80,1000838,1000839,1000840,1000841,1000842,115,49]},{"originalStartLineNumberOneIndexed":556,"originalEndLineNumberExclusiveOneIndexed":558,"modifiedStartLineNumberOneIndexed":583,"modifiedEndLineNumberExclusiveOneIndexed":597,"addedLines":["      ","      // Save playback position before unmounting","      const video = videoRef.current;","      if (video && currentVideoUrl) {","        const state = {","          currentTime: video.currentTime,","          wasPlaying: !video.paused,","          timestamp: Date.now(),","        };","        videoPlaybackState.set(currentVideoUrl, state);","        console.log('üíæ Saved playback state:', { currentTime: state.currentTime.toFixed(2), wasPlaying: state.wasPlaying });","      }","    };","  }, [item.post.id, currentVideoUrl]);"],"tokenizedAddedLines":[116,1000843,1000844,1000845,1000846,1000847,1000848,1000849,1000850,1000851,1000852,115,91,1000853]},{"originalStartLineNumberOneIndexed":745,"originalEndLineNumberExclusiveOneIndexed":745,"modifiedStartLineNumberOneIndexed":784,"modifiedEndLineNumberExclusiveOneIndexed":792,"addedLines":["                      ","                      // Restore playback position if we have saved state","                      const savedState = videoPlaybackState.get(currentVideoUrl);","                      if (savedState && Math.abs(video.currentTime - savedState.currentTime) > 0.5) {","                        console.log('‚èÆÔ∏è Restoring playback position:', { from: video.currentTime.toFixed(2), to: savedState.currentTime.toFixed(2) });","                        video.currentTime = savedState.currentTime;","                      }","                      "],"tokenizedAddedLines":[720,1000854,1000855,1000856,1000857,1000858,497,720]},{"originalStartLineNumberOneIndexed":749,"originalEndLineNumberExclusiveOneIndexed":749,"modifiedStartLineNumberOneIndexed":796,"modifiedEndLineNumberExclusiveOneIndexed":797,"addedLines":["                        "],"tokenizedAddedLines":[509]},{"originalStartLineNumberOneIndexed":750,"originalEndLineNumberExclusiveOneIndexed":752,"modifiedStartLineNumberOneIndexed":798,"modifiedEndLineNumberExclusiveOneIndexed":803,"addedLines":["                        // OR if the video was playing before unmount","                        const shouldAutoPlay = savedState?.wasPlaying || (!userPausedRef.current && video.paused);","                        ","                        if (video.paused && shouldAutoPlay) {","                          console.log('‚ñ∂Ô∏è Auto-playing video (onCanPlay)', { currentTime: video.currentTime.toFixed(2), restoringPlayback: !!savedState?.wasPlaying });"],"tokenizedAddedLines":[1000859,1000860,509,1000861,1000862]},{"originalStartLineNumberOneIndexed":755,"originalEndLineNumberExclusiveOneIndexed":755,"modifiedStartLineNumberOneIndexed":806,"modifiedEndLineNumberExclusiveOneIndexed":810,"addedLines":["                            // Clear saved state after successful restore","                            if (savedState) {","                              videoPlaybackState.delete(currentVideoUrl);","                            }"],"tokenizedAddedLines":[1000863,1000864,1000865,1000866]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}