{"fsPath":"\\home\\hendo420\\soraFeed\\src\\components\\VideoPost.tsx","fileUuid":"cead1102-ebe1-4c08-a2dc-e26fab3fc941","fileSizeBytes":36010,"numLines":1020,"diffChanges":[{"originalStartLineNumberOneIndexed":87,"originalEndLineNumberExclusiveOneIndexed":88,"modifiedStartLineNumberOneIndexed":87,"modifiedEndLineNumberExclusiveOneIndexed":91,"addedLines":["  // Video refs - use a Map to track videos by item ID for stable references","  const videoRefsMap = useRef<Map<string, HTMLVideoElement>>(new Map());","  ","  // Legacy refs for compatibility with existing code"],"tokenizedAddedLines":[1000713,1000714,47,1000715]},{"originalStartLineNumberOneIndexed":93,"originalEndLineNumberExclusiveOneIndexed":93,"modifiedStartLineNumberOneIndexed":96,"modifiedEndLineNumberExclusiveOneIndexed":109,"addedLines":["  ","  // Helper to get or create video ref for an item","  const getVideoRefForItem = useCallback((itemId: string, position: 'left' | 'center' | 'right') => {","    return (el: HTMLVideoElement | null) => {","      if (el) {","        videoRefsMap.current.set(itemId, el);","        // Also update position-based refs for backward compatibility","        if (position === 'center') centerVideoRef.current = el;","        else if (position === 'left') leftVideoRef.current = el;","        else if (position === 'right') rightVideoRef.current = el;","      }","    };","  }, []);"],"tokenizedAddedLines":[47,1000716,1000717,1000718,1000719,1000720,1000721,1000722,1000723,1000724,152,392,237]},{"originalStartLineNumberOneIndexed":117,"originalEndLineNumberExclusiveOneIndexed":117,"modifiedStartLineNumberOneIndexed":133,"modifiedEndLineNumberExclusiveOneIndexed":137,"addedLines":["    ","    // During horizontal scrolling, keep center video playing until navigation completes","    // This matches the behavior of up/down scrolling where videos keep playing during transition","    const centerShouldPlay = isActive && !userPausedRef.current;"],"tokenizedAddedLines":[101,1000725,1000726,1000727]},{"originalStartLineNumberOneIndexed":123,"originalEndLineNumberExclusiveOneIndexed":124,"modifiedStartLineNumberOneIndexed":143,"modifiedEndLineNumberExclusiveOneIndexed":144,"addedLines":["      isActive: isActive,"],"tokenizedAddedLines":[1000728]},{"originalStartLineNumberOneIndexed":125,"originalEndLineNumberExclusiveOneIndexed":126,"modifiedStartLineNumberOneIndexed":145,"modifiedEndLineNumberExclusiveOneIndexed":146,"addedLines":["      shouldPlay: centerShouldPlay,"],"tokenizedAddedLines":[1000729]},{"originalStartLineNumberOneIndexed":138,"originalEndLineNumberExclusiveOneIndexed":139,"modifiedStartLineNumberOneIndexed":158,"modifiedEndLineNumberExclusiveOneIndexed":159,"addedLines":["        shouldPlay: false, // Adjacent videos stay paused, matching up/down behavior"],"tokenizedAddedLines":[1000730]},{"originalStartLineNumberOneIndexed":152,"originalEndLineNumberExclusiveOneIndexed":153,"modifiedStartLineNumberOneIndexed":172,"modifiedEndLineNumberExclusiveOneIndexed":173,"addedLines":["        shouldPlay: false, // Adjacent videos stay paused, matching up/down behavior"],"tokenizedAddedLines":[1000730]},{"originalStartLineNumberOneIndexed":230,"originalEndLineNumberExclusiveOneIndexed":230,"modifiedStartLineNumberOneIndexed":250,"modifiedEndLineNumberExclusiveOneIndexed":251,"addedLines":["          // Update index and reset position immediately to prevent visual glitches"],"tokenizedAddedLines":[1000731]},{"originalStartLineNumberOneIndexed":231,"originalEndLineNumberExclusiveOneIndexed":232,"modifiedStartLineNumberOneIndexed":252,"modifiedEndLineNumberExclusiveOneIndexed":253,"addedLines":["          x.set(0);"],"tokenizedAddedLines":[1000732]},{"originalStartLineNumberOneIndexed":233,"originalEndLineNumberExclusiveOneIndexed":236,"modifiedStartLineNumberOneIndexed":254,"modifiedEndLineNumberExclusiveOneIndexed":255,"addedLines":["          // Don't reset video ready states - let videos remain ready for smoother transitions"],"tokenizedAddedLines":[1000733]},{"originalStartLineNumberOneIndexed":243,"originalEndLineNumberExclusiveOneIndexed":246,"modifiedStartLineNumberOneIndexed":262,"modifiedEndLineNumberExclusiveOneIndexed":262},{"originalStartLineNumberOneIndexed":669,"originalEndLineNumberExclusiveOneIndexed":671,"modifiedStartLineNumberOneIndexed":685,"modifiedEndLineNumberExclusiveOneIndexed":685},{"originalStartLineNumberOneIndexed":721,"originalEndLineNumberExclusiveOneIndexed":721,"modifiedStartLineNumberOneIndexed":735,"modifiedEndLineNumberExclusiveOneIndexed":760,"addedLines":["  ","  // Render video elements with stable keys based on item ID to prevent reloading when positions change","  const renderVideoAtPosition = useCallback((itemIndex: number, position: 'left' | 'center' | 'right') => {","    const items = getAllItems();","    if (itemIndex < 0 || itemIndex >= items.length) return null;","    ","    const videoItem = items[itemIndex];","    const videoUrl = videoItem.post.attachments[0]?.encodings?.md?.path || ","                     videoItem.post.attachments[0]?.encodings?.source?.path;","    ","    if (!videoUrl) return null;","    ","    const isCenter = position === 'center';","    const isLeft = position === 'left';","    const isRight = position === 'right';","    ","    // Use position for transform, but item ID as key for stable element identity","    const transform = isLeft ? 'translateX(-100%)' : isRight ? 'translateX(100%)' : 'translateX(0)';","    const zIndex = isCenter ? 20 : 10;","    ","    // Determine if video is ready based on position","    let isReady = false;","    if (isCenter) isReady = videoReady;","    else if (isLeft) isReady = leftVideoReady;","    else if (isRight) isReady = rightVideoReady;"],"tokenizedAddedLines":[47,1000734,1000735,1000736,1000737,101,1000738,1000739,1000740,101,1000741,101,1000742,1000743,1000744,101,1000745,1000746,1000747,101,1000748,1000749,1000750,1000751,1000752]},{"originalStartLineNumberOneIndexed":723,"originalEndLineNumberExclusiveOneIndexed":735,"modifiedStartLineNumberOneIndexed":762,"modifiedEndLineNumberExclusiveOneIndexed":771,"addedLines":["      <div ","        key={videoItem.post.id}","        className=\"absolute inset-0 w-full h-full flex items-center justify-center\"","        style={{ ","          transform,","          zIndex","        }}","      >","        {isCenter ? ("],"tokenizedAddedLines":[1000753,1000754,1000755,1000756,1000757,1000758,1000759,506,1000760]},{"originalStartLineNumberOneIndexed":743,"originalEndLineNumberExclusiveOneIndexed":744,"modifiedStartLineNumberOneIndexed":779,"modifiedEndLineNumberExclusiveOneIndexed":779},{"originalStartLineNumberOneIndexed":745,"originalEndLineNumberExclusiveOneIndexed":747,"modifiedStartLineNumberOneIndexed":780,"modifiedEndLineNumberExclusiveOneIndexed":782,"addedLines":["                ref={getVideoRefForItem(videoItem.post.id, position)}","                src={videoUrl}"],"tokenizedAddedLines":[1000761,1000762]},{"originalStartLineNumberOneIndexed":751,"originalEndLineNumberExclusiveOneIndexed":752,"modifiedStartLineNumberOneIndexed":786,"modifiedEndLineNumberExclusiveOneIndexed":787,"addedLines":["                  opacity: isReady ? 1 : 0,"],"tokenizedAddedLines":[1000763]},{"originalStartLineNumberOneIndexed":762,"originalEndLineNumberExclusiveOneIndexed":763,"modifiedStartLineNumberOneIndexed":797,"modifiedEndLineNumberExclusiveOneIndexed":798,"addedLines":["                <source src={videoUrl} type=\"video/mp4\" />"],"tokenizedAddedLines":[1000764]},{"originalStartLineNumberOneIndexed":764,"originalEndLineNumberExclusiveOneIndexed":765,"modifiedStartLineNumberOneIndexed":799,"modifiedEndLineNumberExclusiveOneIndexed":799},{"originalStartLineNumberOneIndexed":767,"originalEndLineNumberExclusiveOneIndexed":778,"modifiedStartLineNumberOneIndexed":801,"modifiedEndLineNumberExclusiveOneIndexed":802,"addedLines":["        ) : ("],"tokenizedAddedLines":[1000765]},{"originalStartLineNumberOneIndexed":779,"originalEndLineNumberExclusiveOneIndexed":782,"modifiedStartLineNumberOneIndexed":803,"modifiedEndLineNumberExclusiveOneIndexed":805,"addedLines":["            ref={getVideoRefForItem(videoItem.post.id, position)}","            src={videoUrl}"],"tokenizedAddedLines":[1000766,1000767]},{"originalStartLineNumberOneIndexed":784,"originalEndLineNumberExclusiveOneIndexed":785,"modifiedStartLineNumberOneIndexed":807,"modifiedEndLineNumberExclusiveOneIndexed":808,"addedLines":["              opacity: isReady ? 1 : 0,"],"tokenizedAddedLines":[1000768]},{"originalStartLineNumberOneIndexed":791,"originalEndLineNumberExclusiveOneIndexed":824,"modifiedStartLineNumberOneIndexed":814,"modifiedEndLineNumberExclusiveOneIndexed":845,"addedLines":["            onCanPlay={(e) => {","              if (isLeft) handleLeftVideoCanPlay(e.currentTarget);","              else handleRightVideoCanPlay(e.currentTarget);","            }}","            onLoadedData={(e) => {","              if (isLeft) handleLeftVideoCanPlay(e.currentTarget);","              else handleRightVideoCanPlay(e.currentTarget);","            }}","          />","        )}","      </div>","    );","  }, [getAllItems, videoWidth, videoReady, leftVideoReady, rightVideoReady, isMuted, ","      getVideoRefForItem, handleVideoMetadata, handleVideoCanPlay, handleVideoLoad, ","      handleLeftVideoCanPlay, handleRightVideoCanPlay]);","","    return (","    <div className=\"relative w-full h-full bg-black overflow-hidden\">","      {/* Video Container */}","        <motion.div","          {...(bind() as any)}","          style={{ x }}","          className=\"absolute inset-0 flex items-center justify-center group cursor-pointer select-none\"","          onMouseEnter={handleMouseEnter}","          onMouseLeave={handleMouseLeave}","          onClick={handleVideoClick}","      >","        {/* Render videos at their positions with stable keys */}","        {canGoLeft && renderVideoAtPosition(currentRemixIndex - 1, 'left')}","        {renderVideoAtPosition(currentRemixIndex, 'center')}","        {canGoRight && renderVideoAtPosition(currentRemixIndex + 1, 'right')}"],"tokenizedAddedLines":[1000769,1000770,1000771,549,1000772,1000770,1000771,549,1000773,567,713,1000774,1000775,1000776,1000777,2,496,497,498,499,500,501,502,503,504,505,506,1000778,1000779,1000780,1000781]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}